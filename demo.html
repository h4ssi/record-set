<!DOCTYPE html>
<html>
  <head>
    <title>"record-set demo"</title>
    <script src='../platform/platform.js'></script>
    <link href='../polymer/polymer.html' rel='import'>
    <link href='record-set.html' rel='import'>
  </head>
  <body>
    <polymer-element attributes='label' extends='record-base' name='my-record' noscript type='test'></polymer-element>
    <polymer-element extends='my-record' name='my-record-view'>
      <template>
        <li>
          {{type}}: {{rid}} -> {{label}}
          <template if='{{noautoload != undefined}}'>
            <a href='#' id='reload'>Reload</a>
          </template>
          <a href='#' id='delete'>Delete</a>
        </li>
      </template>
      <script>
        (function() {
          Polymer('my-record-view', {
            ready: function() {
              this.load();
              if (this.$.reload != null) {
                this.$.reload.addEventListener("click", (function(_this) {
                  return function(e) {
                    e.preventDefault();
                    e.returnValue = false;
                    return _this.load();
                  };
                })(this));
              }
              return this.$["delete"].addEventListener("click", (function(_this) {
                return function(e) {
                  e.preventDefault();
                  e.returnValue = false;
                  return _this["delete"]();
                };
              })(this));
            }
          });
        
        }).call(this);
      </script>
    </polymer-element>
    <polymer-element name='demo-app'>
      <template>
        <record-set id='data'></record-set>
        <my-record id='x' label='test' persist rid='1'></my-record>
        <my-record id='y' label='test2' persist rid='2'></my-record>
        <p>
          set label to
          <input id='labelField' type='text'>
          <a href='#' id='labelFieldClick'>Change</a>
        </p>
        <h3>autoloading</h3>
        <ul>
          <template repeat='{{$.x.all}}'>
            <my-record-view rid='{{}}'></my-record-view>
          </template>
        </ul>
        <h3>noautoloading</h3>
        <ul>
          <template repeat='{{$.y.all}}'>
            <my-record-view noautoload rid='{{}}'></my-record-view>
          </template>
        </ul>
      </template>
      <script>
        (function() {
          Polymer('demo-app', {
            ready: function() {
              this.$.labelFieldClick.addEventListener("click", (function(_this) {
                return function(e) {
                  e.preventDefault();
                  e.returnValue = false;
                  _this.$.x.label = _this.$.labelField.value;
                  return _this.$.x.save();
                };
              })(this));
              return console.log("ready");
            }
          });
        
        }).call(this);
      </script>
    </polymer-element>
    <demo-app></demo-app>
  </body>
</html>
