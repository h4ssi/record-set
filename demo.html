<!DOCTYPE html>
<html>
  <head>
    <title>"record-set demo"</title>
    <script src='../platform/platform.js'></script>
    <link href='../polymer/polymer.html' rel='import'>
    <link href='record-set.html' rel='import'>
  </head>
  <body>
    <polymer-element attributes='label' extends='record-base' name='my-record' noscript type='my-record'></polymer-element>
    <polymer-element extends='my-record' name='my-record-view'>
      <template>
        <li>
          {{type}}: {{rid}} -> {{label}}
          <a hidden?='{{noautoload == undefined}}' href='#' id='reload'>Reload</a>
          <a href='#' id='delete'>Delete</a>
        </li>
      </template>
      <script>
        (function() {
          Polymer('my-record-view', {
            ready: function() {
              this.load();
              this.$.reload.addEventListener("click", (function(_this) {
                return function(e) {
                  e.preventDefault();
                  e.returnValue = false;
                  return _this.load();
                };
              })(this));
              return this.$["delete"].addEventListener("click", (function(_this) {
                return function(e) {
                  e.preventDefault();
                  e.returnValue = false;
                  return _this.deleteRemote();
                };
              })(this));
            }
          });
        
        }).call(this);
      </script>
    </polymer-element>
    <polymer-element name='demo-app'>
      <template>
        <record-set href='http://localhost:9998' id='data'></record-set>
        <my-record id='x'></my-record>
        <p>
          set label to
          <input id='labelField' type='text'>
          <a hidden?='{{$.x.all.length == 0}}' href='#' id='labelFieldEditClick'>Change 1st record</a>
          <a href='#' id='labelFieldCreateClick'>Create new record</a>
        </p>
        <h3>autoloading</h3>
        <ul>
          <template repeat='{{$.x.all}}'>
            <my-record-view rid='{{}}'></my-record-view>
          </template>
        </ul>
        <h3>noautoloading</h3>
        <ul>
          <template repeat='{{$.x.all}}'>
            <my-record-view noautoload rid='{{}}'></my-record-view>
          </template>
        </ul>
      </template>
      <script>
        (function() {
          Polymer('demo-app', {
            ready: function() {
              this.$.x.pull();
              this.$.labelFieldEditClick.addEventListener("click", (function(_this) {
                return function(e) {
                  e.preventDefault();
                  e.returnValue = false;
                  _this.$.x.rid = _this.$.x.all[0];
                  _this.$.x.label = _this.$.labelField.value;
                  return _this.$.x.saveRemote();
                };
              })(this));
              this.$.labelFieldCreateClick.addEventListener("click", (function(_this) {
                return function(e) {
                  e.preventDefault();
                  e.returnValue = false;
                  _this.$.x.rid = void 0;
                  _this.$.x.label = _this.$.labelField.value;
                  return _this.$.x.createRemote();
                };
              })(this));
              return console.log("ready");
            }
          });
        
        }).call(this);
      </script>
    </polymer-element>
    <demo-app></demo-app>
  </body>
</html>
