<!DOCTYPE html>
<link href='../polymer/polymer.html' rel='import'>
<polymer-element attributes='records' name='record-set'>
  <template></template>
  <script>
    (function() {
      var data;
    
      data = {};
    
      Polymer({
        _data: void 0,
        computed: {
          all: '_extractRecords(_data)'
        },
        ready: function() {
          return this._data = data;
        },
        save: function(type, record) {
          if (this._data[type] == null) {
            this._data[type] = {
              records: {},
              next: 1
            };
          }
          this._data[type].records[this._data[type].next] = record;
          return this._data[type].next++;
        },
        _extractRecords: function(data) {
          return new function() {
            var id, record, type, value;
            for (type in data) {
              value = data[type];
              this[type] = (function() {
                var _ref, _results;
                _ref = value.records;
                _results = [];
                for (id in _ref) {
                  record = _ref[id];
                  _results.push(record);
                }
                return _results;
              })();
            }
            return this;
          };
        }
      });
    
    }).call(this);
  </script>
</polymer-element>
<polymer-element attributes='rid' name='record-base'>
  <template>
    <record-set id='set'></record-set>
  </template>
  <script>
    (function() {
      Polymer({
        rid: void 0,
        computed: {
          type: '_lc(tagName)',
          all: '$.set.all[type]'
        },
        ready: function() {
          if (this.rid != null) {
            return this.save();
          }
        },
        save: function() {
          console.log("test");
          return this.$.set.save(this.type, this);
        },
        _lc: function(s) {
          return s.toLowerCase();
        }
      });
    
    }).call(this);
  </script>
</polymer-element>
